<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />




  


  <link rel="alternate" href="/atom.xml" title="StriveZs的博客" type="application/atom+xml" />






<meta name="description" content="使用SA来解决TSP问题 模拟退火算法基本原理： 模拟退火（SA）算法的出发点是基于物理中固体物质的退火过程与一般的组合优化问题之间的相似性。模拟退火法是一种通用的优化算法，其物理退火过程由以下三部分组成：  加温过程。其目的是增强粒子的热运动，使其偏离平衡位置。当温度足够高时，固体将熔为液体，从而消除系统原先存在的非均匀状态。 等温过程。对于与周围环境交换热量而温度不变的封闭系统，系统状态的自">
<meta property="og:type" content="article">
<meta property="og:title" content="模拟退火算法（SA）解决TSP问题">
<meta property="og:url" content="https://zs670980918.github.io/2018/09/17/mo-ni-tui-huo-suan-fa-sa-jie-jue-tsp-wen-ti-1/index.html">
<meta property="og:site_name" content="StriveZs的博客">
<meta property="og:description" content="使用SA来解决TSP问题 模拟退火算法基本原理： 模拟退火（SA）算法的出发点是基于物理中固体物质的退火过程与一般的组合优化问题之间的相似性。模拟退火法是一种通用的优化算法，其物理退火过程由以下三部分组成：  加温过程。其目的是增强粒子的热运动，使其偏离平衡位置。当温度足够高时，固体将熔为液体，从而消除系统原先存在的非均匀状态。 等温过程。对于与周围环境交换热量而温度不变的封闭系统，系统状态的自">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://47.100.4.8/wp-content/uploads/2018/09/QQ%E5%9B%BE%E7%89%8720180917174510.png">
<meta property="og:image" content="http://47.100.4.8/wp-content/uploads/2018/09/321.png">
<meta property="og:image" content="http://47.100.4.8/wp-content/uploads/2018/09/333.png">
<meta property="og:image" content="http://47.100.4.8/wp-content/uploads/2018/09/333333.png">
<meta property="og:image" content="http://47.100.4.8/wp-content/uploads/2018/09/555555555555.png">
<meta property="og:image" content="http://47.100.4.8/wp-content/uploads/2018/09/666666666666.png">
<meta property="article:published_time" content="2018-09-17T09:57:36.000Z">
<meta property="article:modified_time" content="2018-09-17T09:57:36.000Z">
<meta property="article:author" content="StriveZs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://47.100.4.8/wp-content/uploads/2018/09/QQ%E5%9B%BE%E7%89%8720180917174510.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'StriveZs'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zs670980918.github.io/2018/09/17/mo-ni-tui-huo-suan-fa-sa-jie-jue-tsp-wen-ti-1/"/>





  <title>模拟退火算法（SA）解决TSP问题 | StriveZs的博客</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?5c8bbf815dac51a855060f947b787303";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">StriveZs的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            Schedule
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zs670980918.github.io/2018/09/17/mo-ni-tui-huo-suan-fa-sa-jie-jue-tsp-wen-ti-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="StriveZs">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="StriveZs的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">模拟退火算法（SA）解决TSP问题</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-17T17:57:36+08:00">
                2018-09-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SA/" itemprop="url" rel="index">
                    <span itemprop="name">SA</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SA/TSP%E9%97%AE%E9%A2%98/" itemprop="url" rel="index">
                    <span itemprop="name">TSP问题</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SA/TSP%E9%97%AE%E9%A2%98/%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">优化算法</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SA/TSP%E9%97%AE%E9%A2%98/%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95/%E6%96%87%E7%AB%A0%E9%A1%B5/" itemprop="url" rel="index">
                    <span itemprop="name">文章页</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SA/TSP%E9%97%AE%E9%A2%98/%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95/%E6%96%87%E7%AB%A0%E9%A1%B5/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="http://47.100.4.8/wp-content/uploads/2018/09/QQ%E5%9B%BE%E7%89%8720180917174510.png" alt=""></p>
<p><strong>使用SA来解决TSP问题</strong></p>
<p>模拟退火算法基本原理： 模拟退火（SA）算法的出发点是基于物理中固体物质的退火过程与一般的组合优化问题之间的相似性。模拟退火法是一种通用的优化算法，其物理退火过程由以下三部分组成：</p>
<ul>
<li>加温过程。其目的是增强粒子的热运动，使其偏离平衡位置。当温度足够高时，固体将熔为液体，从而消除系统原先存在的非均匀状态。</li>
<li>等温过程。对于与周围环境交换热量而温度不变的封闭系统，系统状态的自发变化总是朝自由能减少的方向进行的，当自由能达到最小时，系统达到平衡状态。</li>
<li>冷却过程。使粒子热运动减弱，系统能量下降，得到晶体结构。</li>
</ul>
<p>其中，加温过程对应算法的设定初温，等温过程对应算法的Metropolis抽样过程，冷却过程对应控制参数的下降。这里能量的变化就是目标函数，要得到的最优解就是能量低态。Metropolis准则是SA算法收敛于全局最优解的关键所在，Metropolis准则以一定的概率接受恶化解，这样就使算法跳离局部最优的陷阱。 模拟退火算法为求解传统方法难处理的TSP问题提供了一个有效的途径和通用框架，并逐渐发展成一种迭代自适应启发式概率性搜索算法。模拟退火算法可以用求解不同的非线性问题，对不可微甚至不连续的函数优化，能以较大概率求得全局优化解，该算法还具有较强的鲁棒性、全局收敛性、隐含并行性及广泛的适应性，并且能处理不同类型的优化设计变量（离散的、连续的和混合型的），不需要任何的辅助信息，对目标函数和约束函数没有任何要求。利用Metropolis算法并适当地控制温度下降过程，在优化问题中具有很强的竞争力。   SA算法实现过程如下（以最小化问题为例） ：</p>
<ul>
<li>初始化：取初始温度T0足够大，令T=T0，任取初始解S1，确定每个T时的迭代次数，即Metropolis链长L</li>
<li>对当前温度T和k=1,2，……，L重复步骤（3）~（5）</li>
<li>对当前解S1随机扰动产生一个新解S2</li>
<li>计算S2的增量df=f（S2）-f（S1），其中f（S1）为S1的代价函数</li>
<li>若df&lt;0，则接受S2作为新的当前解， 即S1=S2；否则计算S2的接受概率exp（-df/T），即随机产生（0,1）区间上均匀分布的随机数rand，若exp（-df/T）&gt;rand，也接受S2作为新的当前解，S1=S2；否则保留当前解S1。</li>
<li>如果满足终止条件Stop，则输出当前解S1为最优解，结束程序。终止条件Stop通常为：在连续若干个Metropolis链中新解S2都没有被接受时终止算法，或是设定结束温度。否则按衰减函数衰减T后返回步骤（2）。</li>
</ul>
<p>以上步骤称为Metropolis过程。逐渐降低控制温度，重复Metropolis过程，直至满足结束准备则Stop，求出最优解。   算法流程： <img src="http://47.100.4.8/wp-content/uploads/2018/09/321.png" alt=""> 模拟退火算法实现： （1）控制参数的设置 需要设置的主要参数有降温速率q、初始温度T0、结束温度Tend以及链长L。 （2）初始解 对于n个城市的TSP问题，得到的解就是对1~n的一个排序，其中每个数字为对应城市的编号，如对10个城市的TSP问题{1,2,3,4,5,6,7,8,9,10}，则|1|3|5|2|4|9|7|8|6|10|就是一个合法的解，采用产生随机排列的方法产生一个初始的解S。 （3）解变换生成新解 通过对当前解S1进行变换，产生新的路径数组即新解，这里采用的变换是产生随机数的方法来产生将要交换的两个城市，用二邻域变换法产生新的路径，即新的可行解S2。 （4）Metropolis准则fdf 若路径长度函数为f（S），则当前解的路径为f（S1），新解的路径为f（S2），路径差为 df=f（S2）-f（S1），则Metropolis准则为： <img src="http://47.100.4.8/wp-content/uploads/2018/09/333.png" alt=""> 如果df&lt;0，则以概率1接收新的路径了；否则以概率exp（-df/T）接收新的路径。 （5）降温 利用降温速率q进行降温，即T=qT，若T小于结束温度，则停止迭代输出当前状态，否则继续迭代。   程序实现 主程序代码：</p>
<p>clc;<br>clear;<br>close all;<br>%%<br>tic<br>T0=1000;   % 初始温度<br>Tend=1e-3;  % 终止温度<br>L=500;    % 各温度下的迭代次数（链长L）<br>q=0.9;    %降温速率</p>
<p>%% 加载数据<br>load CityPosition1;<br>%%<br>D=Distanse(X);  %计算距离矩阵<br>N=size(D,1);    %城市的个数<br>%% 初始解<br>S1=randperm(N);  %随机产生一个初始路线</p>
<p>%% 画出随机解的路径图<br>DrawPath(S1,X)<br>pause(0.0001)<br>%% 输出随机解的路径和总距离<br>disp(‘初始种群中的一个随机值:’)<br>OutputPath(S1);  %输出用-&gt;表示的路径<br>Rlength=PathLength(D,S1); %输出路径总长度<br>disp([‘总距离：’,num2str(Rlength)]);</p>
<p>%% 计算迭代的次数Time<br>%参考下面代码来修改solve式子<br>%syms x<br>%eqn = sin(x) == 1;<br>%solx = solve(eqn,x)<br>syms x;<br>eqns = 1000<em>(0.9)^x == Tend; %Time表示通过计算得到的迭代次数<br>Time=ceil(double(solve(eqns,x)));  %ceil（小数）为朝着大整数 取整<br>count=0;        %迭代计数<br>Obj=zeros(Time,1);         %目标值矩阵初始化<br>track=zeros(Time,N);       %每代的最优路线矩阵初始化<br>%% 迭代<br>while T0&gt;Tend<br>    count=count+1;     %更新迭代次数<br>    temp=zeros(L,N+1);<br>    for k=1:L<br>        %% 产生新解<br>        S2=NewAnswer(S1);<br>        %% Metropolis法则判断是否接受新解<br>        [S1,R]=Metropolis(S1,S2,D,T0);  %Metropolis 抽样算法<br>        temp(k,:)=[S1 R];          %记录下一路线的及其路程<br>    end<br>    %% 记录每次迭代过程的最优路线<br>    [d0,index]=min(temp(:,end)); %找出当前温度下最优路线<br>    if count==1 || d0&lt;Obj(count-1)<br>        Obj(count)=d0;           %如果当前温度下最优路程小于上一路程则记录当前路程<br>    else<br>        Obj(count)=Obj(count-1);%如果当前温度下最优路程大于上一路程则记录上一路程<br>    end<br>    track(count,:)=temp(index,1:end-1);  %记录当前温度的最优路线<br>    T0=q</em>T0;     %降温<br>    fprintf(1,’%d\n’,count)  %输出当前迭代次数<br>end<br>%% 优化过程迭代图<br>figure<br>plot(1:count,Obj)<br>xlabel(‘迭代次数’)<br>ylabel(‘距离’)<br>title(‘优化过程’)</p>
<p>%% 最优解的路径图<br>DrawPath(track(end,:),X)</p>
<p>%% 输出最优解的路线和总距离<br>disp(‘最优解:’)<br>S=track(end,:);<br>p=OutputPath(S);<br>disp([‘总距离：’,num2str(PathLength(D,S))]);<br>disp(‘————————————————————-‘)<br>toc</p>
<p>Distance函数：</p>
<p>function D=Distanse(a)<br>%% 计算两两城市之间的距离<br>%输入 a  各城市的位置坐标<br>%输出 D  两两城市之间的距离<br>row=size(a,1);  %得到城市总数<br>D=zeros(row,row);  %初始化城市距离矩阵<br>%计算每一个城市和其他城市之间的距离<br>for i=1:row<br>    for j=i+1:row<br>        D(i,j)=((a(i,1)-a(j,1))^2+(a(i,2)-a(j,2))^2)^0.5;<br>        D(j,i)=D(i,j);<br>    end<br>end</p>
<p>DrawPath函数：</p>
<p>function DrawPath(Chrom,X)<br>%% 画路径函数<br>%输入<br>% Chrom  待画路径<br>% X      各城市坐标位置<br>R=[Chrom(1,:) Chrom(1,1)]; %一个随机解(个体)  构成路径的循环<br>figure;<br>hold on<br>%% 画点操作<br>plot(X(:,1),X(:,2),’o’,’color’,[0.5,0.5,0.5])<br>plot(X(Chrom(1,1),1),X(Chrom(1,1),2),’rv’,’MarkerSize’,20) %标出起始点的位置<br>for i=1:size(X,1)<br>    text(X(i,1)+0.05,X(i,2)+0.05,num2str(i),’color’,[1,0,0]);<br>end<br>%% 画线操作<br>A=X(R,:);<br>row=size(A,1); %得到路径上经过城市数（包括头尾城市）<br>for i=2:row<br>    [arrowx,arrowy] = dsxy2figxy(gca,A(i-1:i,1),A(i-1:i,2));%坐标转换<br>    annotation(‘textarrow’,arrowx,arrowy,’HeadWidth’,8,’color’,[0,0,1]);<br>end<br>%% 构图信息<br>hold off<br>xlabel(‘横坐标’)<br>ylabel(‘纵坐标’)<br>title(‘轨迹图’)<br>box on </p>
<p>Output函数：</p>
<p>function p=OutputPath(R)<br>%% 输出路径函数<br>%输入：R 路径<br>R=[R,R(1)];<br>N=length(R);<br>p=num2str(R(1));<br>for i=2:N<br>    p=[p,’—&gt;’,num2str(R(i))];<br>end<br>disp(p) </p>
<p>PathLength函数：</p>
<p>function len=PathLength(D,Chrom)<br>%% 计算各个体的路径长度<br>% 输入：<br>% D     两两城市之间的距离<br>% Chrom 个体的轨迹<br>[row,col]=size(D); %得到距离矩阵的长和宽<br>NIND=size(Chrom,1); %城市总数 也就得到了总的路径条数<br>len=zeros(NIND,1);<br>for i=1:NIND %遍历每条路径<br>    p=[Chrom(i,:) Chrom(i,1)]; %构成经过城市循环<br>    i1=p(1:end-1);<br>    i2=p(2:end);<br>    len(i,1)=sum(D((i1-1)*col+i2)); %路径累加<br>end </p>
<p>Metropolis函数：</p>
<p>function [S,R]=Metropolis(S1,S2,D,T)<br>%% 输入<br>% S1：  当前解<br>% S2:   新解<br>% D:    距离矩阵（两两城市的之间的距离）<br>% T:    当前温度<br>%% 输出<br>% S：   下一个当前解<br>% R：   下一个当前解的路线距离<br>%%<br>%首先根据距离矩阵分别计算两个解的路径长度<br>R1=PathLength(D,S1);  %计算路线长度<br>N=length(S1);         %得到城市的个数</p>
<p>R2=PathLength(D,S2);  %计算路线长度<br>dC=R2-R1;   %计算能力之差<br>if dC&lt;0       %如果能力降低 接受新路线<br>    S=S2;<br>    R=R2;<br>elseif exp(-dC/T)&gt;=rand   %以exp(-dC/T)概率接受新路线<br>    S=S2;<br>    R=R2;<br>else        %不接受新路线<br>    S=S1;<br>    R=R1;<br>End </p>
<p>  随机的路径图： <img src="http://47.100.4.8/wp-content/uploads/2018/09/333333.png" alt=""> 优化后的路径图： <img src="http://47.100.4.8/wp-content/uploads/2018/09/555555555555.png" alt=""> 优化过程； <img src="http://47.100.4.8/wp-content/uploads/2018/09/666666666666.png" alt=""> 初始种群中的一个随机值: 7—&gt;5—&gt;14—&gt;2—&gt;3—&gt;12—&gt;10—&gt;6—&gt;8—&gt;11—&gt;13—&gt;9—&gt;4—&gt;1—&gt;7 总距离：69.3773 最优解: 9—&gt;11—&gt;8—&gt;13—&gt;7—&gt;12—&gt;6—&gt;5—&gt;4—&gt;3—&gt;14—&gt;2—&gt;1—&gt;10—&gt;9 总距离：29.3405 ------------------------------------------------------------- 时间已过 3.718870 秒。   附加：CityPosition包 16.4700000000000        96.1000000000000 16.4700000000000        94.4400000000000 20.0900000000000        92.5400000000000 22.3900000000000        93.3700000000000 25.2300000000000        97.2400000000000 22                                         96.0500000000000 20.4700000000000        97.0200000000000 17.2000000000000        96.2900000000000 16.3000000000000        97.3800000000000 14.0500000000000        98.1200000000000 16.5300000000000        97.3800000000000 21.5200000000000        95.5900000000000 19.4100000000000        97.1300000000000 20.0900000000000        92.5500000000000</p>

      
    </div>
    
    
    

    
      <div>
        <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/path/to/your/wechatqcode ex. /uploads/wechat-qcode.jpg" alt="StriveZs wechat" style="width: 200px; max-width: 100%;"/>
    <div>Where is will, there is a way.</div>
</div>

      </div>
    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/09/17/mo-ni-tui-huo-suan-fa-sa-jie-jue-tsp-wen-ti/" rel="next" title="模拟退火算法（SA）解决TSP问题">
                <i class="fa fa-chevron-left"></i> 模拟退火算法（SA）解决TSP问题
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/09/28/gei-pycharm-an-zhuang-qtdesigner-1/" rel="prev" title="给PyCharm安装QtDesigner">
                给PyCharm安装QtDesigner <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.JPG"
                alt="StriveZs" />
            
              <p class="site-author-name" itemprop="name">StriveZs</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">503</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">162</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">StriveZs</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
