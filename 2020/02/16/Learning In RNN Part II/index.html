<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />



  <link rel="icon" type="image/png" sizes="32x32" href="/images/favision.JPG?v=5.1.4">







  <meta name="keywords" content="Python,Machine Learning,RNN," />





  <link rel="alternate" href="/atom.xml" title="StriveZs的博客" type="application/atom+xml" />






<meta name="description" content="Learning In RNN Part II Learning Tager: Make the loss be minimize that evaluating by cost function.  ¶Unfortunately  RNN-based network is not always easy to learn.    Th error surface is rought   ¶Hel">
<meta property="og:type" content="article">
<meta property="og:title" content="Learning In RNN Part II">
<meta property="og:url" content="www.strivezs.com/2020/02/16/Learning%20In%20RNN%20Part%20II/index.html">
<meta property="og:site_name" content="StriveZs的博客">
<meta property="og:description" content="Learning In RNN Part II Learning Tager: Make the loss be minimize that evaluating by cost function.  ¶Unfortunately  RNN-based network is not always easy to learn.    Th error surface is rought   ¶Hel">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/kHcMXX.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/8bJy2V.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/dy4doG.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/EDrdli.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/K5bxC0.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/XKwMQM.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/QuBJ2j.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/kCJIsg.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/WPPHRn.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/3yexBF.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/HjyAMK.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/8Gu1j2.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/BRp1UF.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/By7XBu.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/wYKkpA.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/eCiGf3.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/RARIzh.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/zYlxJy.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/tTKbLU.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/CGfD3r.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/0szRES.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/Ajbf8o.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/h4FdpY.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/ErGx83.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/opnM0d.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/QyhNhJ.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/ADclLS.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/JKDhvu.jpg">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/ssXaWg.png">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/zryrFy.jpg">
<meta property="og:image" content="https://gitee.com/zyp521/upload_image/raw/master/GJhyYd.png">
<meta property="article:published_time" content="2020-02-16T04:04:20.591Z">
<meta property="article:modified_time" content="2020-02-16T04:04:20.591Z">
<meta property="article:author" content="StriveZs">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Machine Learning">
<meta property="article:tag" content="RNN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/zyp521/upload_image/raw/master/kHcMXX.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'StriveZs'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="www.strivezs.com/2020/02/16/Learning In RNN Part II/"/>



<div id="tp-weather-widget"></div>
  <script>
    (function(a,h,g,f,e,d,c,b){b=function(){d=h.createElement(g);c=h.getElementsByTagName(g)[0];d.src=e;d.charset="utf-8";d.async=1;c.parentNode.insertBefore(d,c)};a["SeniverseWeatherWidgetObject"]=f;a[f]||(a[f]=function(){(a[f].q=a[f].q||[]).push(arguments)});a[f].l=+new Date();if(a.attachEvent){a.attachEvent("onload",b)}else{a.addEventListener("load",b,false)}}(window,document,"script","SeniverseWeatherWidget","//cdn.sencdn.com/widget2/static/js/bundle.js?t="+parseInt((new Date().getTime() / 100000000).toString(),10)));
    window.SeniverseWeatherWidget('show', {
      flavor: "bubble",
      location: "WX4FBXXFKE4F",
      geolocation: true,
      language: "zh-Hans",
      unit: "c",
      theme: "dark",
      token: "cec3125e-f640-4fcf-b6f2-6f0cdc38a0ae",
      hover: "enabled",
      container: "tp-weather-widget"
    })
  </script>


  <title>Learning In RNN Part II | StriveZs的博客</title>
  <!-- 球型气泡标签云 -->
  <!--  <script type="text/javascript" src="/js/src/bubble.js"></script>   暂时不用了-->
    
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?5c8bbf815dac51a855060f947b787303";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    
    <a href="https://github.com/zs670980918" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">StriveZs的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Blog</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            Schedule
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="www.strivezs.com/2020/02/16/Learning%20In%20RNN%20Part%20II/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="StriveZs">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="StriveZs的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Learning In RNN Part II</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-02-16T12:04:20+08:00">
                2020-02-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%87%E7%AB%A0%E9%A1%B5/" itemprop="url" rel="index">
                    <span itemprop="name">文章页</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%87%E7%AB%A0%E9%A1%B5/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%87%E7%AB%A0%E9%A1%B5/Python/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%87%E7%AB%A0%E9%A1%B5/Python/Machine-Learning/Neural-NetWork/" itemprop="url" rel="index">
                    <span itemprop="name">Neural NetWork</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/02/16/Learning%20In%20RNN%20Part%20II/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/02/16/Learning%20In%20RNN%20Part%20II/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1>Learning In RNN Part II</h1>
<p><strong>Learning Tager:</strong> Make the loss be minimize that evaluating by cost function.</p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/kHcMXX.png" alt="figure1"></p>
<h2 id="Unfortunately"><a class="header-anchor" href="#Unfortunately">¶</a>Unfortunately</h2>
<ul>
<li>RNN-based network is not always easy to learn.</li>
</ul>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/8bJy2V.png" alt="figure2"></p>
<ul>
<li>Th error surface is rought</li>
</ul>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/dy4doG.png" alt="figure3"></p>
<h2 id="Helpful-Techniques"><a class="header-anchor" href="#Helpful-Techniques">¶</a>Helpful Techniques</h2>
<h3 id="Long-Short-term-Memory-LSTM"><a class="header-anchor" href="#Long-Short-term-Memory-LSTM">¶</a>Long Short-term Memory(LSTM)</h3>
<h4 id="Why-replace-RNN-to-LSTM"><a class="header-anchor" href="#Why-replace-RNN-to-LSTM">¶</a>Why replace RNN to LSTM?</h4>
<p>Can deal with gradient vanishing(消灭，等于0) (not gradient explode爆炸激增)<br>
It can make your error surface to be flatting nor not steep.<br>
The specify performance is that it can remove the flat regions and solve the problem of gradient vanishing, but not gradient explode.</p>
<h4 id="How-to-work"><a class="header-anchor" href="#How-to-work">¶</a>How to work:</h4>
<p>The different operation between RNN and LSTM is that RNN can reomve value in memory after each computation and store new value. But LSTM can add the previous value to new value in cell memory after each computation.(Concretely depend on the value of forget gate)<br>
So the difference of RNN and LSTM is if a weight influence value of memory, the influence never disappears unless forget gate is closed.<br>
If forget gate is opened, there no gradient vanishing.</p>
<h4 id="Summarization"><a class="header-anchor" href="#Summarization">¶</a>Summarization</h4>
<ul>
<li>can deal with gradient vanishing(not gradient explode)</li>
<li>Memory and input are <ins>added</ins></li>
<li>The influence never disappears<br>
unless forget gate is closed</li>
<li>No Gradient vanishing(If forget gate is opened)</li>
</ul>
<p>Gated Recurrent Unit(GRU):simpier thant LSTM</p>
<p><strong>Other helpful techniques:</strong></p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/EDrdli.png" alt="figure4"></p>
<h2 id="More-Applications"><a class="header-anchor" href="#More-Applications">¶</a>More Applications</h2>
<h3 id="Many-to-one"><a class="header-anchor" href="#Many-to-one">¶</a>Many to one</h3>
<ul>
<li>Input is a vector sequence, but output is only one vector.</li>
</ul>
<p><strong>Sentiment Analysis:(意见分析)</strong></p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/K5bxC0.png" alt="figure5"></p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/XKwMQM.png" alt="figure6"></p>
<h3 id="Many-to-Many-Output-is-shorter"><a class="header-anchor" href="#Many-to-Many-Output-is-shorter">¶</a>Many to Many (Output is shorter)</h3>
<ul>
<li>Both input and output are both sequences, <strong>but the output is shorter</strong>.</li>
</ul>
<p><strong>Speech Recognition:</strong></p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/QuBJ2j.png" alt="figure7"></p>
<h4 id="How-to-differentiate"><a class="header-anchor" href="#How-to-differentiate">¶</a>How to differentiate?</h4>
<ul>
<li>Connectionist Temporal Classification(<strong>CTC</strong>，联结主义时间分类)</li>
</ul>
<p>==Add an extra symbol “Φ” representing “null”.==</p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/kCJIsg.png" alt="figure8"></p>
<p>Use this method to slove the problem like differentiate “好棒” or “好棒棒”.</p>
<h4 id="CTC-Training"><a class="header-anchor" href="#CTC-Training">¶</a>CTC Training</h4>
<p><strong>Acoustic Features:(声音特征)</strong><br>
ALL possible alignments(序列/顺序) are considered as correct because we don’t know what alignment is correct. So we can list all alignments to train.</p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/WPPHRn.png" alt="figure9"></p>
<h4 id="CTC-example"><a class="header-anchor" href="#CTC-example">¶</a>CTC: example</h4>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/3yexBF.png" alt="figure10"></p>
<h3 id="Many-to-Many-No-Limitation"><a class="header-anchor" href="#Many-to-Many-No-Limitation">¶</a>Many to Many (No Limitation)</h3>
<ul>
<li>Both input and output are both sequences <strong>with differnet lengths</strong>. ➡ <strong>Sequence to sequence learning</strong><br>
<strong>Machine Translate</strong>(Machine Learning ➡ 机器学习)</li>
</ul>
<p><strong>bag-of-word:</strong></p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/HjyAMK.png" alt="figure11"></p>
<p>Above model can’t stop until it’s interrupted.</p>
<h4 id="How-to-make-the-network-stop"><a class="header-anchor" href="#How-to-make-the-network-stop">¶</a>How to make the network stop</h4>
<ul>
<li>Adda a symbol ‘===’(断)</li>
</ul>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/8Gu1j2.png" alt="figure12"></p>
<h3 id="Beyond-Sequence"><a class="header-anchor" href="#Beyond-Sequence">¶</a>Beyond Sequence</h3>
<ul>
<li>Syntactic parsing(句法分析)</li>
</ul>
<h4 id="Transform-Tree-Structure-to-sequence"><a class="header-anchor" href="#Transform-Tree-Structure-to-sequence">¶</a>Transform Tree Structure to sequence</h4>
<p><strong>Conversion principle:</strong></p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/BRp1UF.png" alt="figure13"></p>
<p>We can transform sentence tree to sequence by using this principle and train a sequence model to recognize sentence.</p>
<h3 id="Sequence-to-sequence"><a class="header-anchor" href="#Sequence-to-sequence">¶</a>Sequence-to-sequence</h3>
<h4 id="Auto-encoder-Text"><a class="header-anchor" href="#Auto-encoder-Text">¶</a>Auto-encoder-Text</h4>
<ul>
<li>To understand the meaning of a word sequence, the order of the words can not be ignored.</li>
</ul>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/By7XBu.png" alt="figure14"></p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/wYKkpA.png" alt="figure15"></p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/eCiGf3.png" alt="figure16"></p>
<h4 id="Auto-encoder-Speech"><a class="header-anchor" href="#Auto-encoder-Speech">¶</a>Auto-encoder-Speech</h4>
<ul>
<li>Dimension reduction for a sequence with variable length</li>
</ul>
<p>audio segments()word-level-&gt;Fixed-length vector</p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/RARIzh.png" alt="figure17"></p>
<h5 id="Audio-Search-Principle"><a class="header-anchor" href="#Audio-Search-Principle">¶</a><strong>Audio Search Principle:</strong></h5>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/zYlxJy.png" alt="figure18"></p>
<h5 id="How-to-transform-audio-segment-to-vector"><a class="header-anchor" href="#How-to-transform-audio-segment-to-vector">¶</a>How to transform audio segment to vector</h5>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/tTKbLU.png" alt="figure19"></p>
<p>ps: jointly 共同地 同时地 similarity 相似 类似 embedding 埋入/埋葬</p>
<h5 id="Visualizing-embedding-vectors-of-the-words"><a class="header-anchor" href="#Visualizing-embedding-vectors-of-the-words">¶</a>Visualizing embedding vectors of the words</h5>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/CGfD3r.png" alt="figure20"></p>
<h4 id="Sequence-to-sequence-Learning-Demo-Chat-bot"><a class="header-anchor" href="#Sequence-to-sequence-Learning-Demo-Chat-bot">¶</a>Sequence-to-sequence Learning Demo:Chat-bot</h4>
<p><strong>Learning Principle:</strong></p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/0szRES.png" alt="figure21"></p>
<p><strong>Data Set:</strong><br>
40000 sentences in Movie album and discussion of presidential election in American.</p>
<h2 id="Attention-based-Model"><a class="header-anchor" href="#Attention-based-Model">¶</a>Attention-based Model</h2>
<p><strong>Structure Version 1:</strong></p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/Ajbf8o.png" alt="figure22"></p>
<p><strong>Structure Version 2:</strong><br>
==Neural Turing Machine(神经图灵机)==</p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/h4FdpY.png" alt="figure23"></p>
<h3 id="Reading-Comprehension"><a class="header-anchor" href="#Reading-Comprehension">¶</a>Reading Comprehension</h3>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/ErGx83.png" alt="figure24"></p>
<h3 id="Visual-Question-Answering"><a class="header-anchor" href="#Visual-Question-Answering">¶</a>Visual Question Answering</h3>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/opnM0d.png" alt="figure25"></p>
<p><strong>Principle:</strong><br>
==A vector for each region==</p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/QyhNhJ.png" alt="figure26"></p>
<h3 id="Speech-Question-Answering"><a class="header-anchor" href="#Speech-Question-Answering">¶</a>Speech Question Answering</h3>
<ul>
<li>TOEFL Listening Comprehension Test By Machine</li>
</ul>
<p><strong>Example:</strong></p>
<ol>
<li>Audio Story: the original story is 5 min long</li>
<li>Question: “what is possible of Venus’ clouds?”</li>
<li>Choices:
<ol>
<li>gased released as a result of volcanic activity</li>
<li>chemical reactions caused by high surface temperatures</li>
<li>bursts of radio energy from the plane’s surface</li>
<li>strong winds that blow dust into the atmosphere</li>
</ol>
</li>
</ol>
<h4 id="Model-Architecture"><a class="header-anchor" href="#Model-Architecture">¶</a>Model Architecture</h4>
<p>Everything is learned from training examples.</p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/ADclLS.png" alt="figure27"></p>
<h2 id="Deep-Structure"><a class="header-anchor" href="#Deep-Structure">¶</a>Deep &amp; Structure</h2>
<h3 id="Integrated-together"><a class="header-anchor" href="#Integrated-together">¶</a>Integrated together</h3>
<ul>
<li>Speech Recognition: CNN/LSTM/DNN+HMM<br>
<img src="https://gitee.com/zyp521/upload_image/raw/master/JKDhvu.jpg" alt="figure28"></li>
</ul>
<p>Bayes theorem</p>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/ssXaWg.png" alt="figure29"></p>
<ul>
<li>Sematic Tagging: Bi-directional LSTM+CRF/Structured SVM<br>
Testing:<br>
<img src="https://gitee.com/zyp521/upload_image/raw/master/zryrFy.jpg" alt="figure31"></li>
</ul>
<p><img src="https://gitee.com/zyp521/upload_image/raw/master/GJhyYd.png" alt="figure30"></p>

      
    </div>
    
    
    

    
      <div>
        <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/images/wechat.jpg" alt="StriveZs wechat" style="width: 200px; max-width: 100%;"/>
    <div>Hobby lead  creation, technology change world.</div>
</div>

      </div>
    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:</strong>
    StriveZs
  </li>
  <li class="post-copyright-link">
    <strong>Post link:</strong>
    <a href="www.strivezs.com/2020/02/16/Learning%20In%20RNN%20Part%20II/" title="Learning In RNN Part II">www.strivezs.com/2020/02/16/Learning%20In%20RNN%20Part%20II/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice: </strong>
    All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> unless stating additionally.
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Python/" rel="tag"># Python</a>
          
            <a href="/tags/Machine-Learning/" rel="tag"># Machine Learning</a>
          
            <a href="/tags/RNN/" rel="tag"># RNN</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/02/16/%E5%B0%86%E5%9F%9F%E5%90%8D%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A7%A3%E6%9E%90%E5%88%B0github%20page%E4%B8%8A/" rel="next" title="将域名从服务器解析到github page上">
                <i class="fa fa-chevron-left"></i> 将域名从服务器解析到github page上
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/02/22/%E4%BD%BF%E7%94%A8CDN%E5%8A%A0%E9%80%9Fgithub%20page%E8%AE%BF%E9%97%AE/" rel="prev" title="使用CDN加速github page访问">
                使用CDN加速github page访问 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.JPG"
                alt="StriveZs" />
            
              <p class="site-author-name" itemprop="name">StriveZs</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">339</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">224</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">224</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="http://www.home.strivezs.com/" target="_blank" title="Home">
                      
                        <i class="fa fa-fw fa-home"></i>Home</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/zs670980918" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="zs670980918@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://blog.csdn.net/qq_16184125" target="_blank" title="CSDN">
                      
                        <i class="fa fa-fw fa-bug"></i>CSDN</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://space.bilibili.com/32353303" target="_blank" title="BiLiBiLi">
                      
                        <i class="fa fa-fw fa-bold"></i>BiLiBiLi</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/5417471468/profile?rightmod=1&wvr=6&mod=personinfo" target="_blank" title="微博">
                      
                        <i class="fa fa-fw fa-weibo"></i>微博</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/StriveZs" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.youtube.com/channel/UC3iJKUkUdlvN6DY2qP1x2Sg/featured?view_as=subscriber" target="_blank" title="YouTube">
                      
                        <i class="fa fa-fw fa-youtube"></i>YouTube</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">1.</span> <span class="nav-text">Learning In RNN Part II</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Unfortunately"><span class="nav-number">1.1.</span> <span class="nav-text">¶Unfortunately</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Helpful-Techniques"><span class="nav-number">1.2.</span> <span class="nav-text">¶Helpful Techniques</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Long-Short-term-Memory-LSTM"><span class="nav-number">1.2.1.</span> <span class="nav-text">¶Long Short-term Memory(LSTM)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Why-replace-RNN-to-LSTM"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">¶Why replace RNN to LSTM?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#How-to-work"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">¶How to work:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Summarization"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">¶Summarization</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#More-Applications"><span class="nav-number">1.3.</span> <span class="nav-text">¶More Applications</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Many-to-one"><span class="nav-number">1.3.1.</span> <span class="nav-text">¶Many to one</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Many-to-Many-Output-is-shorter"><span class="nav-number">1.3.2.</span> <span class="nav-text">¶Many to Many (Output is shorter)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#How-to-differentiate"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">¶How to differentiate?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CTC-Training"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">¶CTC Training</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CTC-example"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">¶CTC: example</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Many-to-Many-No-Limitation"><span class="nav-number">1.3.3.</span> <span class="nav-text">¶Many to Many (No Limitation)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#How-to-make-the-network-stop"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">¶How to make the network stop</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Beyond-Sequence"><span class="nav-number">1.3.4.</span> <span class="nav-text">¶Beyond Sequence</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Transform-Tree-Structure-to-sequence"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">¶Transform Tree Structure to sequence</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sequence-to-sequence"><span class="nav-number">1.3.5.</span> <span class="nav-text">¶Sequence-to-sequence</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Auto-encoder-Text"><span class="nav-number">1.3.5.1.</span> <span class="nav-text">¶Auto-encoder-Text</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Auto-encoder-Speech"><span class="nav-number">1.3.5.2.</span> <span class="nav-text">¶Auto-encoder-Speech</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Audio-Search-Principle"><span class="nav-number">1.3.5.2.1.</span> <span class="nav-text">¶Audio Search Principle:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#How-to-transform-audio-segment-to-vector"><span class="nav-number">1.3.5.2.2.</span> <span class="nav-text">¶How to transform audio segment to vector</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Visualizing-embedding-vectors-of-the-words"><span class="nav-number">1.3.5.2.3.</span> <span class="nav-text">¶Visualizing embedding vectors of the words</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Sequence-to-sequence-Learning-Demo-Chat-bot"><span class="nav-number">1.3.5.3.</span> <span class="nav-text">¶Sequence-to-sequence Learning Demo:Chat-bot</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Attention-based-Model"><span class="nav-number">1.4.</span> <span class="nav-text">¶Attention-based Model</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Reading-Comprehension"><span class="nav-number">1.4.1.</span> <span class="nav-text">¶Reading Comprehension</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Visual-Question-Answering"><span class="nav-number">1.4.2.</span> <span class="nav-text">¶Visual Question Answering</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Speech-Question-Answering"><span class="nav-number">1.4.3.</span> <span class="nav-text">¶Speech Question Answering</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Model-Architecture"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">¶Model Architecture</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Deep-Structure"><span class="nav-number">1.5.</span> <span class="nav-text">¶Deep &amp; Structure</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Integrated-together"><span class="nav-number">1.5.1.</span> <span class="nav-text">¶Integrated together</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

      
      
        <!-- canvas粒子时钟 -->
        
<div style="">
  <canvas id="canvas" style="width:60%;">当前浏览器不支持canvas，请更换浏览器后再试</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //声明canvas的宽高
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //存储时间数据
    var data = [];
    //存储运动的小球
    var balls = [];
    //设置粒子半径
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //存储时间数字，由十位小时、个位小时、冒号、十位分钟、个位分钟、冒号、十位秒钟、个位秒钟这7个数字组成
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*生成点阵数字*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*更新时钟*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //时间发生变化
            if(NewData[i] !== data[i]){
                //将变化的数字值和在data数组中的索引存储在changeNumArray数组中
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //增加小球
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*更新小球状态*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*增加要运动的小球*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*渲染*/
    function render(){
        //重置画布宽度，达到清空画布的效果
        canvas.height = 100;
        //渲染时钟
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //渲染小球
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //更新时钟
        updateDigitTime();
        //更新小球状态
        updateBalls();
        //渲染
        render();
    },50);
}

})();
</script>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">StriveZs</span>

  
</div>

<script type="text/javascript" src="//rf.revolvermaps.com/0/0/5.js?i=5b3ac4cx0nk&amp;m=0&amp;c=ff0000&amp;cr1=ffffff" async="async"></script>

<div class=BbeiAn-info">
  皖ICP备 -
  <a href="http://www.miitbeian.gov.cn/">18004602</a>
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>



        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: true,
        notify: true,
        appId: 'KqICB5D6mxxGk3BP6KIJz0ar-gzGzoHsz',
        appKey: 'YsAzygIOG5S4oWgdymQBthCv',
        placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊!',
        avatar:'wavatar',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/nico.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
